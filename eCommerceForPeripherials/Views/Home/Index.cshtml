@model IEnumerable<eCommerceForPeripherials.Models.Item>

@{
    ViewData["Title"] = "Index";
}

@{
    if (Model != null)
    {
        <div class="row" style="padding-top:3%;">
        @foreach(var item in Model)
        {
            <div class="col-sm-4 product" style="border:1px solid white;">
              <h3 class="card-header">@item.Brand</h3>
              <div class="card-body">
                <a asp-controller="Shop" asp-action="Details" asp-route-id="@item.Id" class="text-muted"><h5 class="card-title">@item.Name</h5></a>
                @*<h6 class="card-subtitle text-muted">Wireless: @item.Wireless</h6>*@
              </div>
              <div class="product_img" style=""> <img class="img-responsive" src="@item.ItemImageUrl" alt=""> </div>
  
              <div class="card-body">
              @{
                    try
                    {
                        <p class="card-text">@item.Description.Remove(70)<a class="btn btn-link text-muted" asp-controller="Shop" asp-action="Details" asp-route-id="@item.Id">..ვრცლად</a></p>
                    }catch(Exception ex)
                    {
                        <p class="card-text">@item.Description</p>
                    }
                    
                }
              </div>
              <ul class="list-group list-group-flush">
                <li class="list-group-item text-muted">უკაბელო: @item.Wireless</li>
                <li class="list-group-item text-muted">მდგომარეობა: @item.ItemCondition</li>
                <li class="list-group-item text-muted">კავშირის ტიპი: @item.Connection</li>
              </ul>
              <div class="card-body">
              @if (User.IsInRole("Admin"))
              {
                  <div class="modal" style="">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">ნივთის წაშლა</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true"></span>
                                    </button>
                                </div>
                            <div class="modal-body">
                                <p>დარწმუნებული ხარ რომ გინდა წაშალო @item.Name?</p>
                            </div>
                            <div class="modal-footer">
                            <form asp-action="DeleteItem" method="post" asp-controller="Admin" asp-route-id="@item.Id">
                            <button type="submit" class="btn btn-outline-danger">Delete</button>
                            </form>
                                @*<button type="button" class="btn btn-outline-danger">Delete</button>*@
                                <button type="button" onclick="closeModal(@item.Id)" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                            </div>
                        </div>
                  </div>
                  

                  <button type="button" onclick="document.getElementsByClassName('modal')[@item.Id].style.display='block';" class="btn btn-outline-danger">Delete</button>
                  

                    //<form asp-action="DeleteItem" method="post" asp-controller="Admin" asp-route-id="@item.Id">
                    //<button type="submit" class="btn btn-outline-danger">Delete</button>
                    //</form>
                }
                @*<a href="#" class="card-link">დეტალურად</a>*@
                @*<a href="#" class="card-link">Another link</a>*@
              </div>
              <div class="card-footer text-muted">
                2 days ago
              </div>
            </div>
            
        }
        </div>
    }

}


<script>

    //window.onload = function(){
    //    var modal = document.getElementsByClassName("modal");
    //    console.log(modal);
    //}

//    var modal = document.getElementsByClassName("modal");

//    for(var j=0;j<modal.length;j++){

//        modal[j].style.display = 'hidden';
//    }

    function DelModal(i) {
    document.getElementsByClassName("modal")[i].style.display = 'block';
}

window.onclick = function (event) {
    let modal = document.getElementsByClassName("modal");
    for (var i = 0; i < modal.length; i++) {
        if (event.target == modal[i]) {
            modal[i].style.display = "none";
        }
    }
}

function closeModal(l) {
    console.log(l);
    let modal = document.getElementsByClassName("modal");
    var v = l;
    modal[v].style.display = "none";
}

</script>